---
import BaseLayout from '@/layouts/BaseLayout.astro';
---

<BaseLayout title="搜索">
  <section class="max-w-3xl mx-auto px-4 py-10">
    <h1 class="text-3xl font-bold mb-6">搜索</h1>
    <div id="search" class="pagefind-search"></div>
  </section>
  <script is:inline>
    // 在构建后的静态环境中加载 Pagefind UI
    (async () => {
      if (import.meta.env.DEV) return;
      const script = document.createElement('script');
      script.src = '/pagefind/pagefind.js';
      script.defer = true;
      script.onload = () => {
        window.pagefindUI = new PagefindUI({
          element: '#search',
          showSubResults: true,
          showImages: true,
          translations: { placeholder: '搜索文章...' },
        });
      };
      document.head.appendChild(script);
      const style = document.createElement('link');
      style.rel = 'stylesheet';
      style.href = '/pagefind/pagefind.css';
      document.head.appendChild(style);
    })();
  </script>
</BaseLayout>
